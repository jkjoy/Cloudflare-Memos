# Memos - è½»é‡çº§å¤‡å¿˜å½•ç³»ç»Ÿ

[![éƒ¨ç½²çŠ¶æ€](https://img.shields.io/badge/éƒ¨ç½²-Cloudflare%20Workers-orange)](https://workers.cloudflare.com/)
[![æ•°æ®åº“](https://img.shields.io/badge/æ•°æ®åº“-Cloudflare%20D1-blue)](https://developers.cloudflare.com/d1/)
[![å­˜å‚¨](https://img.shields.io/badge/å­˜å‚¨-Cloudflare%20R2-green)](https://developers.cloudflare.com/r2/)

ä¸€ä¸ªåŸºäº Cloudflare Workers çš„ç°ä»£åŒ–å¤‡å¿˜å½•ç®¡ç†ç³»ç»Ÿï¼Œæä¾›å®Œæ•´çš„ API å’Œ Web ç•Œé¢ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ“ **å¤‡å¿˜å½•ç®¡ç†** - åˆ›å»ºã€æŸ¥çœ‹ã€ç¼–è¾‘ã€åˆ é™¤å¤‡å¿˜å½•
- ğŸ“ **æ–‡ä»¶ä¸Šä¼ ** - æ”¯æŒå›¾ç‰‡ç­‰æ–‡ä»¶é™„ä»¶
- ğŸ” **å®‰å…¨è®¤è¯** - TOKEN è®¤è¯ä¿æŠ¤æ•æ„Ÿæ“ä½œ
- ğŸ‘¥ **ç”¨æˆ·ç³»ç»Ÿ** - å¤šç”¨æˆ·æ”¯æŒï¼Œé¦–ä½ç”¨æˆ·è‡ªåŠ¨æˆä¸ºç®¡ç†å‘˜
- ğŸŒ **å“åº”å¼ç•Œé¢** - ç°ä»£åŒ– Web ç•Œé¢ï¼Œæ”¯æŒç§»åŠ¨ç«¯
- âš¡ **è¾¹ç¼˜è®¡ç®—** - åŸºäº Cloudflare Workersï¼Œå…¨çƒä½å»¶è¿Ÿ
- ğŸ—„ï¸ **é›¶è¿ç»´** - æ— æœåŠ¡å™¨æ¶æ„ï¼Œè‡ªåŠ¨æ‰©å±•

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Node.js 16+
- Cloudflare è´¦æˆ·
- Wrangler CLI


### æ‰‹åŠ¨éƒ¨ç½²


# 1. å®‰è£…ä¾èµ–
```bash
npm install
```
# 2. ç™»å½• Cloudflare
```bash
wrangler login
```
# 3. åˆ›å»ºæ•°æ®åº“
```bash
wrangler d1 create memos_db
```
# 4. æ›´æ–° wrangler.toml ä¸­çš„ `database_id`

å°† `wrangler.toml` æ–‡ä»¶ä¸­çš„ `database_id` æ›´æ–°ä¸ºä¸Šä¸€æ­¥åˆ›å»ºçš„æ•°æ®åº“ IDã€‚

# 5. åˆå§‹åŒ–æ•°æ®åº“
```bash
wrangler d1 execute memos_db --file=./schema.sql --remote
```

# 6. åˆ›å»ºå­˜å‚¨æ¡¶
```bash
wrangler r2 bucket create memos
```

~~# 7. è®¾ç½®è®¿é—®ä»¤ç‰Œ~~
~~wrangler secret put TOKEN~~

# 8. éƒ¨ç½²
```bash
wrangler deploy
```

## ğŸ“– API æ–‡æ¡£

### è®¤è¯

éœ€è¦æƒé™çš„æ¥å£éœ€è¦åœ¨è¯·æ±‚ä¸­åŒ…å« TOKENï¼š

```bash
# è¯·æ±‚å¤´æ–¹å¼
Authorization: Bearer YOUR_TOKEN
# æˆ–
X-Token: YOUR_TOKEN

# æŸ¥è¯¢å‚æ•°æ–¹å¼
?token=YOUR_TOKEN
```

### å¤‡å¿˜å½•æ¥å£

| æ–¹æ³• | è·¯å¾„ | æè¿° | æƒé™ |
|------|------|------|------|
| GET | `/api/v1/memo` | è·å–å¤‡å¿˜å½•åˆ—è¡¨ | æ— éœ€ |
| GET | `/api/v1/memo/:id` | è·å–å•ä¸ªå¤‡å¿˜å½• | æ— éœ€ |
| POST | `/api/v1/memo` | åˆ›å»ºå¤‡å¿˜å½• | éœ€è¦ |
| PUT | `/api/v1/memo/:id` | æ›´æ–°å¤‡å¿˜å½• | éœ€è¦ |
| DELETE | `/api/v1/memo/:id` | åˆ é™¤å¤‡å¿˜å½• | éœ€è¦ |

### ç”¨æˆ·æ¥å£

| æ–¹æ³• | è·¯å¾„ | æè¿° | æƒé™ |
|------|------|------|------|
| GET | `/api/v1/user` | è·å–ç”¨æˆ·åˆ—è¡¨ | éœ€è¦ |
| POST | `/api/v1/user` | åˆ›å»ºç”¨æˆ· | é¦–æ¬¡éƒ¨ç½²æ—¶é¦–ä¸ªç”¨æˆ·æ— éœ€ï¼›ä¹‹åéœ€è¦ç®¡ç†å‘˜æˆ–æœåŠ¡ç«¯TOKEN |

### èµ„æºæ¥å£

| æ–¹æ³• | è·¯å¾„ | æè¿° | æƒé™ |
|------|------|------|------|
| GET | `/api/v1/resource/:id` | è·å–èµ„æº | æ— éœ€ |
| POST | `/api/v1/resource` | ä¸Šä¼ æ–‡ä»¶ | éœ€è¦ |
| GET | `/api/v1/resourceList` | è·å–èµ„æºåˆ—è¡¨ | éœ€è¦ |

## ğŸŒ Web ç•Œé¢

- **é¦–é¡µ**: `https://your-worker.workers.dev/` - å¤‡å¿˜å½•åˆ—è¡¨å’Œåˆ›å»º
- **è¯¦æƒ…é¡µ**: `https://your-worker.workers.dev/m/:id` - å¤‡å¿˜å½•è¯¦æƒ…å’Œç¼–è¾‘

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Web ç•Œé¢      â”‚â”€â”€â”€â–¶â”‚ Cloudflare       â”‚â”€â”€â”€â–¶â”‚ Cloudflare D1   â”‚
â”‚   RESTful API   â”‚    â”‚ Workers          â”‚    â”‚ æ•°æ®åº“          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚ Cloudflare R2   â”‚
                       â”‚ æ–‡ä»¶å­˜å‚¨        â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
memos/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ handlers/          # API å¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ memos.js      # å¤‡å¿˜å½•æ¥å£
â”‚   â”‚   â”œâ”€â”€ users.js      # ç”¨æˆ·æ¥å£
â”‚   â”‚   â”œâ”€â”€ resources.js  # èµ„æºæ¥å£
â”‚   â”‚   â””â”€â”€ web.js        # Web ç•Œé¢
â”‚   â”œâ”€â”€ utils/            # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ auth.js       # è®¤è¯ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ cors.js       # CORS é…ç½®
â”‚   â””â”€â”€ index.js          # ä¸»å…¥å£
â”œâ”€â”€ schema.sql            # æ•°æ®åº“ç»“æ„
â”œâ”€â”€ wrangler.toml         # Workers é…ç½®
â”œâ”€â”€ package.json          # é¡¹ç›®ä¾èµ–
```

## ğŸ”§ æœ¬åœ°å¼€å‘

```bash
# å¯åŠ¨æœ¬åœ°å¼€å‘æœåŠ¡å™¨
npm run dev

# åˆå§‹åŒ–æœ¬åœ°æ•°æ®åº“
npm run db:local

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
npm run tail
```

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### åˆ›å»ºå¤‡å¿˜å½•

```bash
curl -X POST "https://your-worker.workers.dev/api/v1/memo" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"content": "æˆ‘çš„ç¬¬ä¸€æ¡å¤‡å¿˜å½•"}'
```

### ä¸Šä¼ æ–‡ä»¶

```bash
curl -X POST "https://your-worker.workers.dev/api/v1/resource" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -F "file=@image.jpg"
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ™ è‡´è°¢

- [Cloudflare Workers](https://workers.cloudflare.com/) - æ— æœåŠ¡å™¨è®¡ç®—å¹³å°
- [Cloudflare D1](https://developers.cloudflare.com/d1/) - æ— æœåŠ¡å™¨æ•°æ®åº“
- [Cloudflare R2](https://developers.cloudflare.com/r2/) - å¯¹è±¡å­˜å‚¨æœåŠ¡
- [itty-router](https://github.com/kwhitley/itty-router) - è½»é‡çº§è·¯ç”±å™¨